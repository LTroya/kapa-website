---
import KapaTexture from "@/assets/images/footer/kapa-texture.webp?url";
import KapaIcon from "@/assets/icons/footer/kapa.svg";
import Title from "@/components/ui/Title.astro";

const links = [
	{
		title: "Solutions",
		children: [
			{ title: "How it works", href: "#" },
			{ title: "Pricing", href: "/pricing" },
			{ title: "Why us", href: "#" },
			{ title: "Testimonials", href: "#" },
			{ title: "Samples", href: "#" },
			{ title: "Case studies", href: "#" },
		],
	},
	{
		title: "Company",
		children: [
			{ title: "Contact us", href: "#" },
			{ title: "LinkedIn", href: "#" },
			{ title: "FAQ's", href: "#" },
			{ title: "Kapa vs Others", href: "#" },
			{ title: "Knowledge base", href: "#" },
			{ title: "Blog", href: "#" },
		],
	},
];

const firstColumn = links[0];
const secondColumn = links[1];
---

<div class="bg-night-blue border-y border-[rgba(102,153,255,0.20)]">
	<div class="site-container">
		<div class="flex grid-cols-2 lg:grid">
			<div class="flex grow items-center">
				<KapaIcon />
			</div>
			<div class="justify-between lg:flex lg:border-l lg:border-[rgba(102,153,255,0.20)]">
				<div class="space-y-2 px-6 py-10 lg:space-y-0">
					<Title type="h6" class="text-neutral-95">+1 (786) 2203376</Title>
					<Title type="h6" class="text-neutral-95 lg:hidden">help@kapa99.com</Title>
				</div>
				<div class="hidden px-6 py-10 lg:block lg:border-l lg:border-[rgba(102,153,255,0.20)]">
					<Title type="h6" class="text-neutral-95">help@kapa99.com</Title>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="bg-night-blue grid grid-cols-1 lg:grid-cols-2">
	<div></div>
	<div class="grid grid-cols-2 justify-between">
		<div class="px-6 py-10">
			<span class="text-blue mb-4 block">{firstColumn.title}</span>
			{
				firstColumn.children.map((link) => (
					<a
						class="footer-nav-link text-k-md text-neutral-95 hover:text-pumpkin mb-3 flex items-center gap-x-2 transition-colors"
						href={link.href}
						data-href={link.href}
						data-active="false"
					>
						<div class="active-circle h-2 w-2 flex-shrink-0 rounded-full opacity-0 transition-opacity" />
						{link.title}
					</a>
				))
			}
		</div>
		<div class="px-6 py-10">
			<span class="text-blue mb-4 block">{secondColumn.title}</span>
			{
				secondColumn.children.map((link) => (
					<a
						class="footer-nav-link text-k-md text-neutral-95 hover:text-pumpkin mb-3 flex items-center gap-x-2 transition-colors"
						href={link.href}
						data-href={link.href}
						data-active="false"
					>
						<div class="active-circle h-2 w-2 flex-shrink-0 rounded-full opacity-0 transition-opacity" />
						{link.title}
					</a>
				))
			}
		</div>
	</div>
</div>

<img src={KapaTexture} class="w-full" alt="Kapa texture" />

<div class="bg-night-blue">
	<div class="site-container py-10 lg:px-20">
		<div class="text-k-sm text-neutral-80 flex flex-col justify-between lg:flex-row">
			<span class="text-center">Â© 2025 Kapa. All rights reserved.</span>

			<div class="flex justify-center gap-x-16">
				<a href="#">Terms and Conditions</a>
				<a href="#">Privacy Policy</a>
			</div>
		</div>
	</div>
</div>

<script>
	// Function to update active states based on current path
	function updateActiveStates() {
		let currentPath = window.location.pathname;

		// Normalize path by removing trailing slash (except for root)
		if (currentPath.endsWith("/") && currentPath !== "/") {
			currentPath = currentPath.slice(0, -1);
		}

		const footerLinks = document.querySelectorAll(".footer-nav-link");

		footerLinks.forEach((link) => {
			const href = link.getAttribute("data-href");
			const circle = link.querySelector(".active-circle");

			// Determine if this link should be active
			let isActive = false;

			if (href === "#") {
				// Hash links are active when on home page
				isActive = currentPath === "/";
			} else {
				// Exact path matches
				isActive = currentPath === href;
			}

			// Update the data-active attribute
			link.setAttribute("data-active", isActive.toString());

			// Update styles based on data-active attribute
			if (isActive) {
				link.classList.add("font-medium");
				link.classList.remove("hover:text-pumpkin");
				circle.classList.add("bg-pumpkin", "opacity-100");
				circle.classList.remove("opacity-0");
			} else {
				link.classList.remove("font-medium");
				link.classList.add("hover:text-pumpkin");
				circle.classList.remove("bg-pumpkin", "opacity-100");
				circle.classList.add("opacity-0");
			}
		});
	}

	// Update active states on page load
	document.addEventListener("DOMContentLoaded", updateActiveStates);

	// Update active states when the URL changes (for client-side routing)
	window.addEventListener("popstate", updateActiveStates);

	// Optional: Update active states when clicking links (for immediate feedback)
	document.addEventListener("click", (event) => {
		const link = event.target.closest(".footer-nav-link");
		if (link) {
			// Small delay to allow navigation to complete
			setTimeout(updateActiveStates, 10);
		}
	});
</script>
